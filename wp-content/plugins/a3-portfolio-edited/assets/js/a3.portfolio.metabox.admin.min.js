jQuery(function(e){e(document).on("change",".a3-portfolio-meta-tag-link",function(){if(e(this).val()!="0"){e(this).parents("tr").siblings("tr").find(".portfolio_meta_link_url_row").slideUp()}else{e(this).parents("tr").siblings("tr").find(".portfolio_meta_link_url_row").slideDown()}});var t;var n=e("#portfolio_image_gallery");var r=e("#portfolio_images_container ul.portfolio_images");e(".add_portfolio_images").on("click","a",function(i){var s=e(this);var o=n.val();i.preventDefault();if(t){t.open();return}t=wp.media.frames.portfolio_gallery=wp.media({title:s.data("choose"),button:{text:s.data("update")},states:[new wp.media.controller.Library({title:s.data("choose"),filterable:"all",multiple:true})]});t.on("select",function(){var e=t.state().get("selection");e.map(function(e){e=e.toJSON();if(e.id){o=o?o+","+e.id:e.id;r.append('					<li class="image" data-attachment_id="'+e.id+'">						<img src="'+e.url+'" />						<ul class="actions">							<li><a href="#" class="delete" title="'+s.data("delete")+'">'+s.data("text")+"</a></li>						</ul>					</li>")}});n.val(o)});t.open()});r.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:true,forceHelperSize:false,helper:"clone",opacity:.65,placeholder:"metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style")},update:function(t,r){var i="";e("#portfolio_images_container ul li.image").css("cursor","default").each(function(){var t=e(this).attr("data-attachment_id");i=i+t+","});n.val(i)}});e("#portfolio_images_container").on("click","a.delete",function(){e(this).closest("li.image").remove();var t="";e("#portfolio_images_container ul li.image").css("cursor","default").each(function(){var n=e(this).attr("data-attachment_id");t=t+n+","});n.val(t);return false})})